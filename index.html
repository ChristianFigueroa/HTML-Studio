<!DOCTYPE html>
<html lang='en-US'>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>HTML Studio &#183; ChristianFigueroa.GitHub.io</title>
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
	<style type="text/css">
		body, html {
			margin: 0;
			height: 100%;
			position: relative;
		}

		#measurementReference {
			height: 1rem;
			width: 1pt;
			visibility: hidden;
			pointer-events: none;
			position: absolute;
			top: -1rem;
			left: -1pt;
		}
		.contextmenuitem {
			background: #F2F2F2;
			font-family: Arial,Calibri, Sego UI, Arial, sans-serif;
		}

		.contextmenu {
			padding: .2em 0;
			background-color: #F2F2F2;
			border: 1px solid #DDD;
			box-shadow: .2rem .2rem .4rem 0 rgba(80,80,80,.8);
		}

		.contextmenu:not(.subcontextmenu) {
			font-size: 88%;
		}

		#framecontainer {
			min-height: 80%;
			width: auto;
			position: relative;
		}

		#frame, #frameoverlay, #frameback {
			height: 100%;
			width: 100%;
		}

		#frameback {
			background: #90A4AE;
			background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AwRFQ0T3Dgy0QAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAQklEQVRYw+3WsQkAIAxFQRXnyMgZMpM4gqCgzb0+HPwqPTPbaVV1fDvap8BgMBgMBoPfN2/+pogwNRgMBoPBYPC+BUKAB6LfGhNrAAAAAElFTkSuQmCC');
		}

		#frame {
			position: absolute;
			top: 0;
			left: 0;
			border: 0;
		}

		#frameoverlay {
			position: absolute;
			top: 0;
			left: 0;
			overflow: auto;
		}

		#toolbarcontainer {
			height: 20%;
			background: #F0F0F0;
			border-bottom: 1px solid #888;
			margin-bottom: -1px;
			z-index: 1;
			position: relative;
			box-shadow: 0 2px 3px 3px rgba(0,0,0,.18);
		}

		#headersectionbar {
			padding-left: 8%;
			font-size: 0;
			position: absolute;
			top: calc(1% + 2.2rem);
		}

		.headersection {
			display: inline-block;
			font-family: Arial, sans-serif;
			padding: .3em .55em;
			vertical-align: top;
			cursor: default;
			position: relative;
			font-size: initial;
		}

		.headersection:hover {
			background: #DDD;
		}

		#titlebar {
			text-align: center;
			position: absolute;
			width: 100%;
			font-family: Arial, sans-serif;
			margin-top: .5%;
		}

		#title {
			min-width: 20%;
			max-width: 85%;
			display: inline-block;
			font-size: 1.2rem;
			background: #F0F0F0;
			border: 0;
			text-align: center;
			font-family: Arial, sans-serif;
			padding: .05rem 0;
		}

		#title:hover, #title:focus {
			background: #FFF;
			box-shadow: 0 0 5px 2px rgba(0,172,193,.4);
			border: 1px solid #00acc1;
			margin: -1px;
		}

		#titlewidth {
			display: inline;
			position: absolute;
			visibility: hidden;
			pointer-events: none;
			max-width: 85%;
			left: 0;
			font-size: 1.2rem;
		}

		.placeholder {
			color: rgba(0,0,0,.38);
			font-style: italic;
		}

		#logo {
			height: 100%;
			display: inline-block;
			width: 7%;
			background: #00acc1;
		}

		#tooltip {
			background: #F2F2F2;
			width: 50%;
			height: 8vh;
			position: absolute;
			top: 90%;
			left: 25%;
			box-shadow: .3rem .3rem .6rem 0 rgba(0,0,0,.6);
			border: 1px solid #CCC;
			margin: -1px;
			border-radius: 20vh 8vh 8vh 20vh;
		}

		#tooltip_icon {
			height: 6vh;
			width: 6vh;
			border-radius: 50%;
			background: url("svg/tooltip_icon.svg");
			box-shadow: 0 0 3px 1.5px rgba(0,0,0,.3);
			background-size: contain;
			top: 1vh;
			left: 1vh;
			position: absolute;
		}

		#tooltipinner {
			padding-left: 8vh;
			height: 100%;
			width: auto;
		}

		#tooltiptextcont {
			width: 100%;
			height: 100%;
			display: table;
		}

		#tooltiptext {
			display: table-cell;
			vertical-align: middle;
			text-align: center;
			font-family: Arial, sans-serif;
		}
	</style>
</head>
<body>
	<div id='measurementReference'></div>
	<div id='toolbarcontainer'>
		<div id='titlebar'>
			<input type='text' id='title' placeholder='Untitled HTML Document' title='Click to edit'>
			<div id='titlewidth'></div>
		</div>
		<div id='headersectionbar'>
			<div class='headersection' id='section_file'>File</div>
			<div class='headersection' id='section_edit'>Edit</div>
			<div class='headersection' id='section_view'>View</div>
		</div>
		<div id='logo'></div>
	</div>
	<div id='framecontainer'>
		<div id='frameback'></div>
		<iframe id='frame'></iframe>
		<div id='frameoverlay'></div>
	</div>
	<div id='tooltip'>
		<div id='tooltip_icon'></div>
		<div id='tooltipinner'>
			<div id='tooltiptextcont'>
				<div id='tooltiptext'>Extra information will appear here</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		"use strict";
		!function(){
			window.em = function(){
				return Math.round(document.getElementById('measurementReference').getBoundingClientRect().height * (arguments.length ? +arguments[0]: 1) * 1000) / 1000 + (arguments[1] ? 'px' : 0);
			}
			window.pt = function(){
				return Math.round(document.getElementById('measurementReference').getBoundingClientRect().width * (arguments.length ? +arguments[0] : 1) * 1000) / 1000 + (arguments[1] ? 'px' : 0);
			}
			window.ContextMenu = function ContextMenu (args) {
				this.getItem = function(arg){
					for (var children = this.node.children, i = children.length - 1; i >= 0; i--) {
						if (children[i].id == this.id + '-item-' + (arg||0)) return children[i]
					}
				}
				this.node = document.createElement('ul');
				this.node.root = this.node;
				this.id = this.node.id = 'context-' + new Date().getTime().toString(36);
				this.node.className = 'contextmenu';
				this.node.style.listStyle = 'none';
				this.node.style.display = 'inline-block';
				this.node.style.position = 'absolute';
				this.node.style.left = this.node.style.top = '0';
				this.node.style.zIndex = 1000;
				for (var i = args.items.length - 1; i >= 0; i--) {
					(function(){
						var li = document.createElement('li'), image = document.createElement('div'), text = document.createElement('span'), textcontainer = document.createElement('div'), nopad = 'pad' in args.items[i] && !args.items[i].pad, itemplaceholder = args.items[i];
						li.className = 'contextmenuitem';
						li.id = this.id + '-item-' + i;
						li.root = this.node;
						var disabled = args.items[i].disabled;
						Object.defineProperty(li, 'disabled', {
							get: function() {return disabled},
							set: function(v) {
								disabled = v;
								(li.children[1] || li.firstChild).style.color = v ? '#AAA' : ''
								li.title = itemplaceholder[v && itemplaceholder.disabledtitle ? 'disabledtitle' : 'title'];
							},
							enumerable: true,
							configurable: true
						})
						li.func = args.items[i].func;
						// Sets image if pad is true or not included
						if (nopad) {
							li.style.width = 'calc(12rem + 1.7em)';
						} else {
							if (args.items[i].image) image.style.backgroundImage = 'url("' + args.items[i].image + '")';
							// Sets image styles
							image.className = 'contextmenuitemimage'
							image.style.width = '1.4em';
							image.style.height = '1.4em';
							image.style.backgroundSize = '100% 100%';
							image.style.display = 'inline-block';
							image.style.position = 'absolute';
							image.style.left = '.3em';
							image.style.top = '0em';
							image.style.pointerEvents = 'none';
							image.root = this.node;
							li.style.paddingLeft = '2.1em';
							li.appendChild(image);
						}
						textcontainer.style.width = 'auto';
						textcontainer.style.textOverflow = 'ellipsis';
						textcontainer.style.overflowX = 'hidden';
						textcontainer.style.pointerEvents = 'none';
						textcontainer.root = this.node;
						textcontainer.className = 'contextmenuitemtextcontainer';
						if (disabled) textcontainer.style.color = '#AAA';
						li.appendChild(textcontainer)
						// Sets the item's text
						text.className = 'contextmenuitemtext';
						text.innerHTML = args.items[i].name || ' ';
						text.style.pointerEvents = 'none';
						text.style.MozUserSelect = '-moz-none';
						text.style.WebkitUserSelect = 'none';
						text.style.MsUserSelect = 'none';
						text.style.userSelect = 'none';
						text.root = this.node;
						textcontainer.appendChild(text);
						// Sets the item's title if one is defined
						if (args.items[i].title && (!disabled || !args.items[i].disabledtitle)) li.title = args.items[i].title;
						else if (args.items[i].disabledtitle && disabled) li.title = args.items[i].disabledtitle;
						// Sets the item's callback function if one is defined
						if (args.items[i].func) li.addEventListener('click', function(e){
							if (!disabled) li.func.call(this,e,function(){
								li.style.background = '#F5F5F5';
								li.root.parentNode.removeChild(li.root);
							})
						});
						// Sets the item's hover and click color behavior
						li.addEventListener('mouseenter', function(){
							this.style.backgroundColor = disabled ? '#E5E5E5' : '#B2EBF2';
							this.style.whiteSpace = 'pre-line';
							this.style.height = '';
							if (itemplaceholder.subcontext) {
								var context = new ContextMenu(itemplaceholder.subcontext), rect = li.getBoundingClientRect();
								context.node.parent = li;
								context.node.className += ' subcontextmenu';
								context.node.style.top = em(-.2) - 1 + 'px';
								context.node.style.left = rect.width + 'px';
								context.node.style.position = 'absolute';
								this.appendChild(context.node)
							}
						});
						li.addEventListener('mouseleave', function(e){
							this.style.backgroundColor = '';
							this.style.whiteSpace = 'nowrap';
							this.style.height = '1.4em';
							if (itemplaceholder.subcontext) {
								for (var i = this.children.length - 1; i >= 0; i--) {
									if (this.children[i].className.includes('subcontextmenu')) this.removeChild(this.children[i]);
								}
							}
						})
						li.addEventListener('mousedown', function(){this.style.backgroundColor = disabled ? '#E5E5E5' : '#A7ACEF'});
						li.addEventListener('mouseup', function(){this.style.backgroundColor = disabled ? '#E5E5E5' : '#B2EBF2'});
						li.style.padding = li.style.paddingLeft ? '.05em .4em .05em 2.1em' : '.05em .4em';
						li.style.paddingTop = '.075em';
						li.style.paddingBottom = '.025em';
						li.style.paddingRight = '.4em';
						li.style.paddingLeft = li.style.paddingLeft || '.4em';
						li.style.width = li.style.width || '12rem';
						li.style.height = li.style.minHeight = '1.4em';
						li.style.textOverflow = 'ellipsis';
						li.style.whiteSpace = 'nowrap';
						li.style.position = 'relative';
						if (args.items[i].separate) {
							li.style.marginBottom = 'calc(.2em + 1px)';
							var separator = document.createElement('div');
							separator.className = 'contextmenuitemseparator';
							separator.style.width = 'calc(12rem + 1.7em)';
							separator.style.height = '1px';
							separator.style.backgroundColor = '#C5C5C5';
							separator.style.position = 'relative';
							separator.style.top = '-.15em';
							separator.style.left = '.4em';
							this.node.insertBefore(separator, this.node.firstChild)
						}
						if (args.css) {
							for (var item in args.css) {
								li.style[item] = args.css[item];
							}
						}
						if (args.items[i].css) {
							for (var item in args.items[i].css) {
								li.style[item] = args.items[i].css[item];
							}
						}
						// Appends item to overall context menu
						this.node.insertBefore(li, this.node.firstChild);
					}).call(this)
				}
			}
		}();


		!function(){
			// Run on page load
			var iframe = document.getElementById('frame'), framewindow = iframe.contentWindow, elements = iframe.contentWindow.document.body.childNodes, overlay = document.getElementById('frameoverlay'), history = {
				entries: JSON.parse(localStorage.getItem('documentHistoryEntries')) || [],
				update: function() {
					if (~this.currentEntry && framewindow.document.body.innerHTML == this.entries[this.currentEntry].html && document.getElementById('title').value == this.entries[this.currentEntry].title) return;
					this.currentEntry += 1;
					this.entries[this.currentEntry] = {
						html: framewindow.document.body.innerHTML,
						title: document.getElementById('title').value
					}
					this.entries = this.entries.slice(0,this.currentEntry + 1);
					localStorage.setItem('documentHistoryEntries', JSON.stringify(this.entries))
					localStorage.setItem('documentHistoryCurrentEntry', this.currentEntry)
				}
			}, contextmenus =
				[new ContextMenu({
					items: [{
						name: '[Name]',
						disabled: true,
						pad: false,
						css: {
							fontFamily: 'monospace',
							fontSize: '1.2em'
						},
						separate: true
					},{
						name: 'Edit Styles&#133;',
						title: 'Allows you to edit the element\'s CSS'
					},{
						name: 'Insert Child&#133;',
						title: 'Inserts a child node into the selected node',
						separate: true
					},{
						name: 'Edit Text',
						func: function(_,close) {
							var element = this.root.originElement, boxshadow = element.alias.style.boxShadow, blurred = 0;
							element.alias.setAttribute('contenteditable','');
							overlay.style.pointerEvents = 'none';
							element.alias.focus();
							deselect();
							element.alias.style.boxShadow = '0 0 5px 3px #00acc1';
							var pendingUpdate;
							element.alias.addEventListener('blur', function(e) {
								function temp(e){
									element.alias.dispatchEvent(new Event('blur'));
									framewindow.removeEventListener('click', temp);
									this.removeEventListener('click', temp2);
								}
								function temp2(e) {
									e.stopPropagation();
									framewindow.removeEventListener('click', temp);
									this.removeEventListener('click', temp2);
								}
								if (this.noblur) {
									// This only occurs if an HTML escape sequence replacer was clicked on
									// The contenteditable element remains contenteditable, but the user has the option to click inside the element (continue editing text, keep contenteditable), or outside the element (stop editing, take away contenteditable)
									e.preventDefault();
									this.noblur = false;
									this.focus();
									framewindow.addEventListener('click', temp);
									this.addEventListener('click', temp2);
									return;
								}
								framewindow.removeEventListener('click', temp);
								this.removeEventListener('click', temp2);
								overlay.style.pointerEvents = '';
								this.removeAttribute('contenteditable');
								element.alias.style.boxShadow = boxshadow;
								blurred = 1;
								overlayUpdate();
								history.update();
							});
							element.alias.addEventListener('dblclick', function() {
								this.dispatchEvent(new Event('blur'));
							})
							element.alias.addEventListener('keypress', function(e) {
								if ((e.keyCode == 13 || e.which == 13) && (e.ctrlKey || e.shiftKey || e.altKey)) {
									element.alias.dispatchEvent(new Event('blur'));
								};
								if (pendingUpdate) return;
								pendingUpdate = setTimeout(function() {
									pendingUpdate = 0;
									element.alias.style.boxShadow = boxshadow;
									overlayUpdate();
									if (e.isTrusted) history.update();
									if (!blurred) overlay.style.pointerEvents = 'none';
									for (var children = element.alias.childNodes,i = children.length - 1; i >= 0; i--) {
										if (i && children[i].nodeType == 3 && children[i - 1].nodeType == 3) {
											children[i - 1].textContent += children[i].textContent;
											children[i].parentNode.removeChild(children[i]);
										}
									}
									if (!blurred) {
										element.alias.alias.innerHTML = element.alias.alias.innerHTML.replace(/&(?:amp|#38);((?:[A-z]+|#\d+|#x[A-Fa-f\d]+);)/g, '<span style="border-radius:.2em;background:#00acc1;color:white;pointer-events:initial;cursor:pointer" class="html-escape-sequence-replacer" data-sequence="$&">$&</span>');
										var preelement = element;
										Array.prototype.forEach.call(document.getElementsByClassName('html-escape-sequence-replacer'), function(element) {
											var a = document.createElement('a'), sequence = element.getAttribute('data-sequence');
											a.innerHTML = sequence;
											if (a.innerText == sequence) {
												element.parentNode.removeChild(element);
												return;
											}
											if (!element.parentNode.alias) {
												!function alias (element) {
													if (!element.parentNode.parentNode.alias) alias(element.parentNode);
													var children = element.parentNode.parentNode.childNodes, index = Array.prototype.indexOf.call(children, element.parentNode);
													for (var i = index - 2; i >= 0; i--) {
														if (children[i].className == 'html-escape-sequence-replacer') {
															if (children[i + 1] && children[i + 1].className == 'html-escape-sequence-replacer') index--;
															if (children[i + 1] && children[i + 1].nodeType == 3) index--;
														} else if (children[i].nodeType == 3) {
															if (children[i + 1] && children[i + 1].className == 'html-escape-sequence-replacer') index--;
														}
													}
													element.parentNode.alias = element.parentNode.parentNode.alias.childNodes[index];
												}(element)
											};
											element.title = 'Click to replace with "' + a.innerText + '"';
											element.addEventListener('mousedown', function(e) {
												preelement.alias.noblur = true;
												var count = 0, index = Array.prototype.indexOf.call(element.parentNode.childNodes, element), origIndex = index;
												for (var children = element.parentNode.childNodes, i = index - 1; i >= 0; i--) {
													if (children[i].className == 'html-escape-sequence-replacer') {
														if (children[i + 1] && children[i + 1].className == 'html-escape-sequence-replacer') index--;
														if (children[i + 1] && children[i + 1].nodeType == 3) index--;
													} else if (children[i].nodeType == 3) {
														if (children[i + 1] && children[i + 1].className == 'html-escape-sequence-replacer') index--;
													}
												}
												for (var children = element.parentNode.childNodes, i = origIndex - 1; i >= 0; i--) {
													if (children[i].className != 'html-escape-sequence-replacer' && children[i].nodeType != 3) break;
													if (children[i].className == 'html-escape-sequence-replacer' && children[i].innerText == element.innerText) count++;
												}

												if (!element.parentNode.alias) {
													!function alias (element) {
														if (!element.parentNode.parentNode.alias) alias(element.parentNode);
														var children = element.parentNode.parentNode.childNodes, index = Array.prototype.indexOf.call(children, element.parentNode);
														for (var i = index - 2; i >= 0; i--) {
															if (children[i].className == 'html-escape-sequence-replacer') {
																if (children[i + 1] && children[i + 1].className == 'html-escape-sequence-replacer') index--;
																if (children[i + 1] && children[i + 1].nodeType == 3) index--;
															} else if (children[i].nodeType == 3) {
																if (children[i + 1] && children[i + 1].className == 'html-escape-sequence-replacer') index--;
															}
														}
														element.parentNode.alias = element.parentNode.parentNode.alias.childNodes[index];
													}(element)
												}
												element.parentNode.alias.childNodes[index].textContent = element.parentNode.alias.childNodes[index].textContent.replace(new RegExp('((?:.*?(?=' + sequence + ')' + sequence + '){' + count + '}.*?(?=' + sequence + '))' + sequence + '(.*$)'), function(_,$1,$2){
													return $1 + a.innerText + $2;
												});
												element.parentNode.alias.dispatchEvent(new Event('keypress'));
												element.parentNode.replaceChild(document.createTextNode(a.innerText), element);
											})
										})
									}
									element.alias.style.boxShadow = blurred ? boxshadow : '0 0 5px 3px #00acc1';
								}, 10)
							});
							element.alias.dispatchEvent(new Event('keypress'));
							close();
						},
						title: 'Allows you to edit the element\'s textual content'
					},{
						name: 'Edit as HTML&#133;',
						image: 'svg/edit_as_html.svg',
						title: 'Allows you to edit the node\'s HTML',
						separate: true
					},{
						name: 'Delete Node',
						func: function(_,close) {
							this.root.originElement.alias.parentNode.removeChild(this.root.originElement.alias);
							overlayUpdate();
							history.update();
							close();
						},
						title: 'Removes node from the document',
						disabledtitle: 'This node cannot be removed from the document'
					}]
				}),
				new ContextMenu({
					items: [{
						name: 'Delete Nodes',
						func: function(_,close) {
							var elements = document.querySelectorAll('[data-selected-element=selected]');
							for (var i = elements.length - 1; i >= 0; i--) {
								if (elements[i].alias.parentNode && elements[i].alias != framewindow.document.body) elements[i].alias.parentNode.removeChild(elements[i].alias);
							}
							overlayUpdate();
							history.update();
							close();
						}
					}]
				}),
				new ContextMenu({
					items: [{
						name: 'New',
						disabled: true,
						disabledtitle: 'Work in Progress'
					},{
						name: 'Open&#133;',
						disabled: true,
						disabledtitle: 'Work in Progress'
					},{
						name: 'Download File&#133;',
						disabled: true,
						disabledtitle: 'Work in Progress'
					}]
				}),
				new ContextMenu({
					items: [{
						name: 'Undo',
						disabled: true,
						disabledtitle: 'Work in Progress'
					},{
						name: 'Redo',
						disabled: true,
						disabledtitle: 'Work in Progress'
					}]
				}),
				new ContextMenu({
					items: [{
						name: 'Toolbar',
						disabled: true,
						disabledtitle: 'Work in Progress'
					},{
						name: 'Full Page',
						disabled: true,
						disabledtitle: 'Work in Progress'
					},{
						name: 'HTML Tree',
						disabled: true,
						disabledtitle: 'Work in Progress'
					}]
				})];
			history.currentEntry = +localStorage.getItem('documentHistoryCurrentEntry') || history.entries.length - 1
			framewindow.document.body.innerHTML = history.entries.length ? history.entries[history.currentEntry].html : 'This is the <span style="color: #00acc1; font-family: monospace;">&lt;<span>body</span>&gt;</span> element.<div>And this a <span style="color: #00acc1; font-family: monospace;">&lt;div&gt;</span> element.</div><div>Try clicking on elements<br>to select them</div>';
			if (history.entries.length) document.getElementById('title').value = history.entries[history.currentEntry].title;
			framewindow.document.body.style.background = 'white';
			framewindow.document.body.style.textAlign = 'center';
			framewindow.document.body.style.fontSize = '1.5em';
			framewindow.document.body.style.fontFamily = 'Arial, sans-serif';
			framewindow.document.body.style.margin = '0';
			framewindow.document.head.appendChild(framewindow.document.createElement('title'));
			overlay.alias = framewindow.document.body;


			// Overlay event listeners
			overlay.addEventListener('contextmenu', function(e){
				e.preventDefault();
				e.stopPropagation();
				var index = document.querySelectorAll('[data-selected-element=selected]').length > 1 ? 1 : 0;
				if (!index) overlay.dispatchEvent(new Event('click'));
				if (e.target.className.includes('contextmenu')) document.body.removeChild(document.getElementsByClassName('contextmenu')[0]);
				if (!index) contextmenus[index].getItem(0).firstChild.firstChild.innerHTML = '<span style="color:#33F">body</span>' + (framewindow.document.body.id ? '<span style="color:#009"><wbr>#' + framewindow.document.body.id + '</span>' : '') + (framewindow.document.body.className ? '<span style="color:#F44"><wbr>.' + framewindow.document.body.className.replace(/\s+/g,'<wbr>.') + '</span>' : '');
				if (!index) contextmenus[index].getItem(5).disabled = true;
				document.body.appendChild(contextmenus[index].node);
				var style = contextmenus[index].node.getBoundingClientRect();
				contextmenus[index].node.style.left = e.clientX - (style.width + e.clientX > window.innerWidth ? style.width - window.innerWidth + e.clientX : 0) + 'px';
				contextmenus[index].node.style.top = e.clientY - (style.height + e.clientY > window.innerHeight ? style.height - window.innerHeight + e.clientY : 0) - em() + 'px';
				contextmenus[index].node.originElement = overlay;
			});
			overlay.addEventListener('click', function(e) {
				e.stopPropagation();
				if (e.shiftKey) {
					overlay.style.background = 'rgba(0,0,0,0)';
					overlay.setAttribute('data-selected-element', overlay.getAttribute('data-selected-element') != 'selected' ? 'selected' : '');
					var nodes = document.querySelectorAll('[data-selected-element=selected]');
					if (nodes.length>1) document.getElementById('tooltiptext').innerHTML = nodes.length + ' nodes selected';
					else if (nodes[0]) document.getElementById('tooltiptext').innerHTML = '<span style="font-family:monospace;font-size:1.15em"><span style="color:#33f">' + nodes[0].alias.nodeName.toLowerCase() + '</span>' + (nodes[0].alias.id ? '<span style="color:#009">#' + nodes[0].alias.id + '</span>' : '') + (nodes[0].alias.className ? '<span style="color:#F44">.' + nodes[0].alias.className.replace(/\s+/g,'.') + '</span>' : '') + '</span>';
					else document.getElementById('tooltiptext').innerHTML = 'Extra information will appear here';
				} else {
					overlay.style.background = 'rgba(0,0,0,0)';
					var selected = overlay.getAttribute('data-selected-element') == 'selected';
					deselect();
					overlay.setAttribute('data-selected-element', document.querySelectorAll('[data-selected-element=selected]').length > 1 || !e.isTrusted ? 'selected' : selected ? '' : 'selected');
					if (selected) document.getElementById('tooltiptext').innerHTML = 'Extra information will appear here';
					else document.getElementById('tooltiptext').innerHTML = '<span style="font-family:monospace;font-size:1.15em"><span style="color:#33f">' + overlay.alias.nodeName.toLowerCase() + '</span>' + (overlay.alias.id ? '<span style="color:#009">#' + overlay.alias.id + '</span>' : '') + (overlay.alias.className ? '<span style="color:#F44">.' + overlay.alias.className.replace(/\s+/g,'.') + '</span>' : '') + '</span>';
				}
				if (document.selection) document.selection.empty(),iframewindow.document.selection.empty();
				else if (getSelection) getSelection().removeAllRanges(),framewindow.getSelection().removeAllRanges();
			})



			// Function to update overlay to match iframe
			function overlayUpdate () {
				if (!document.getElementById('frame').contentWindow.document.body) {
					var doc = document.getElementById('frame').contentWindow.document, body = doc.createElement('body');
					doc.documentElement.appendChild(body);
					document.getElementById('frameoverlay').alias = body;
					body.innerHTML = 'The <span style="color: #00acc1; font-family: monospace;">&lt;body&gt;</span> element should not be deleted.<br>All content in the document should be kept as children of the <span>&lt;body&gt;</span> element.';
					body.style.margin = '0';
					body.style.textAlign = 'center';
					body.style.fontFamily = 'Arial, sans-serif';
					body.style.background = 'white';
					body.style.fontSize = '1.5em';
				}
				var elements = framewindow.document.body.childNodes, overlay = document.getElementById('frameoverlay');
				framewindow.document.body.alias = overlay;
				overlay.innerHTML = '';
				for (var i = elements.length - 1; i >= 0; i--) {
					function clone (parent) {
						var clonednode = this.cloneNode();
						this.alias = clonednode;
						clonednode.alias = this;
						if (clonednode instanceof Element || clonednode.nodeType == 1) {

							// On right click pseudo element
							clonednode.addEventListener('contextmenu', function(e){
								e.preventDefault();
								e.stopPropagation();
								var index = document.querySelectorAll('[data-selected-element=selected]').length > 1 ? 1 : 0;
								if (!index) clonednode.dispatchEvent(new Event('click'));
								if (e.target.className.includes('contextmenu')) document.body.removeChild(document.getElementsByClassName('contextmenu')[0]);
								if (!index) contextmenus[index].getItem(0).firstChild.firstChild.innerHTML = '<span style="color:#33F">' + clonednode.nodeName.toLowerCase() + '</span>' + (clonednode.alias.id ? '<span style="color:#009"><wbr>#' + clonednode.alias.id + '</span>' : '') + (clonednode.alias.className ? '<span style="color:#F44"><wbr>.' + clonednode.alias.className.replace(/\s+/g,'<wbr>.') + '</span>' : '');
								if (!index) contextmenus[index].getItem(5).disabled = false;
								document.body.appendChild(contextmenus[index].node);
								var style = contextmenus[index].node.getBoundingClientRect();
								contextmenus[index].node.style.left = e.clientX - (style.width + e.clientX > window.innerWidth ? style.width - window.innerWidth + e.clientX : 0) + 'px';
								contextmenus[index].node.style.top = e.clientY - (style.height + e.clientY > window.innerHeight ? style.height - window.innerHeight + e.clientY : 0) - em() + 'px';
								contextmenus[index].node.originElement = clonednode
							});

							// On left click pseudo element
							clonednode.addEventListener('click', function(e) {
								e.stopPropagation();
								if (e.shiftKey) {
									clonednode.style.background = 'rgba(0,0,0,0)';
									clonednode.setAttribute('data-selected-element', clonednode.getAttribute('data-selected-element') != 'selected' ? 'selected' : '');
									var nodes = document.querySelectorAll('[data-selected-element=selected]');
									if (nodes.length>1) document.getElementById('tooltiptext').innerHTML = nodes.length + ' nodes selected';
									else if (nodes[0]) document.getElementById('tooltiptext').innerHTML = '<span style="font-family:monospace;font-size:1.15em"><span style="color:#33f">' + nodes[0].alias.nodeName.toLowerCase() + '</span>' + (nodes[0].alias.id ? '<span style="color:#009">#' + nodes[0].alias.id + '</span>' : '') + (nodes[0].alias.className ? '<span style="color:#F44">.' + nodes[0].alias.className.replace(/\s+/g,'.') + '</span>' : '') + '</span>';
									else document.getElementById('tooltiptext').innerHTML = 'Extra information will appear here';
								} else {
									clonednode.style.background = 'rgba(0,0,0,0)';
									var selected = clonednode.getAttribute('data-selected-element') == 'selected';
									deselect();
									clonednode.setAttribute('data-selected-element', document.querySelectorAll('[data-selected-element=selected]').length > 1 || !e.isTrusted ? 'selected' : selected ? '' : 'selected');
									if (selected) document.getElementById('tooltiptext').innerHTML = 'Extra information will appear here';
									else document.getElementById('tooltiptext').innerHTML = '<span style="font-family:monospace;font-size:1.15em"><span style="color:#33f">' + clonednode.alias.nodeName.toLowerCase() + '</span>' + (clonednode.alias.id ? '<span style="color:#009">#' + clonednode.alias.id + '</span>' : '') + (clonednode.alias.className ? '<span style="color:#F44">.' + clonednode.alias.className.replace(/\s+/g,'.') + '</span>' : '') + '</span>';
								}
								if (document.selection) document.selection.empty(),iframewindow.document.selection.empty();
								else if (getSelection) getSelection().removeAllRanges(),framewindow.getSelection().removeAllRanges();
							})
							clonednode.style.cursor = 'crosshair';
							clonednode.style.color = 'rgba(0,0,0,0)';
							clonednode.style.background = 'rgba(0,0,0,0)';
						}
						parent.insertBefore(clonednode, parent.firstChild);
						if (this.childNodes.length) {
							for (var i = this.childNodes.length - 1; i >= 0; i--) {
								clone.call(this.childNodes[i], clonednode)
							}
						}
					};
					clone.call(elements[i],overlay);
				}
				var styles = framewindow.document.body.style;
				for (var style in styles) {
					try {
						overlay.style[style] = framewindow.document.body.style[style];
					} catch (_) {}
				};
				overlay.style.cursor = 'crosshair';
				overlay.style.color = 'rgba(0,0,0,0)';
				overlay.style.background = 'rgba(0,0,0,0)';
			}


			// Deselects all elements and set their background back to transparent
			function deselect () {
				Array.prototype.forEach.call(document.querySelectorAll('[data-selected-element=selected]'), function(element) {
					element.setAttribute('data-selected-element','');
					element.style.background = 'rgba(0,0,0,0)';
				})
			}



			var sectionopen = false;
			Array.prototype.forEach.call(document.getElementsByClassName('headersection'), function (element,index,array){
				element.addEventListener('mousedown', function (e){
					e.stopPropagation();
					sectionopen = !sectionopen;
					if (sectionopen) {
						dispatchEvent(new MouseEvent('mousedown'));
						document.body.appendChild(contextmenus[index + 2].node);
						contextmenus[index + 2].node.style.left = this.getBoundingClientRect().left + 'px';
						contextmenus[index + 2].node.style.top = this.getBoundingClientRect().bottom - em() + 'px';
						this.style.background = '#DDD';
					} else {
						document.body.removeChild(contextmenus[index + 2].node);
						this.style.background = '';
					};
					setTimeout(function(){
						if (document.selection) document.selection.empty();
						else if (getSelection) getSelection().removeAllRanges();
					},0)
				});

				element.addEventListener('mouseenter', function (){
					if (!sectionopen) return;
					Array.prototype.forEach.call(array, function(element, index) {
						element.style.background = '';
						try{
							document.body.removeChild(contextmenus[index + 2].node);
						}catch(_){}
					});
					dispatchEvent(new MouseEvent('mousedown'));
					document.body.appendChild(contextmenus[index + 2].node);
					contextmenus[index + 2].node.style.left = this.getBoundingClientRect().left + 'px';
					contextmenus[index + 2].node.style.top = this.getBoundingClientRect().bottom - em() + 'px';
					this.style.background = '#DDD';
				});
			});

			document.getElementById('title').addEventListener('keypress', function(e) {
				if (e.keyCode == 13) return this.blur();
				setTimeout(function(){
					if (!this.value) this.style.fontStyle = 'italic';
					else this.style.fontStyle = ''
					var width = document.getElementById('titlewidth');
					width.innerText = this.value;
					document.getElementById('title').style.width = width.scrollWidth + em(.6) + 'px';
					document.title = (this.value || 'HTML Studio') + ' \xb7 ChristianFigueroa.GitHub.io';
					framewindow.document.querySelector('title').innerText = this.value || 'Untitled HTML Document';
				}.bind(this),0);
			});

			document.getElementById('title').addEventListener('blur', function(){history.update()})

			document.getElementById('title').dispatchEvent(new Event('keypress'));


			window.addEventListener('mousedown',function(e){
				if (!document.getElementsByClassName('contextmenu')[0] || (e.target.className && e.target.className.includes('contextmenu'))) return;
				document.body.removeChild(document.getElementsByClassName('contextmenu')[0] || {});
				if (sectionopen) {
					Array.prototype.forEach.call(document.getElementsByClassName('headersection'), function(element, index) {
						element.style.background = '';
					});
					sectionopen = false;
				}
			});

			function windowkeypress(e) {
				if (e.charCode == 122 && e.ctrlKey) {
					history.currentEntry = Math.max(history.currentEntry - 1, 0);
					framewindow.document.body.innerHTML = history.entries[history.currentEntry].html;
					document.getElementById('title').value = history.entries[history.currentEntry].title;
					overlayUpdate();
					localStorage.setItem('documentHistoryCurrentEntry', history.currentEntry);
				} else if (e.charCode == 121 && e.ctrlKey) {
					history.currentEntry = Math.min(history.currentEntry + 1, history.entries.length - 1);
					framewindow.document.body.innerHTML = history.entries[history.currentEntry].html;
					document.getElementById('title').value = history.entries[history.currentEntry].title;
					overlayUpdate();
					localStorage.setItem('documentHistoryCurrentEntry', history.currentEntry);
				}
			}
			window.addEventListener('keypress', windowkeypress);
			framewindow.addEventListener('keypress', windowkeypress);


			//Interval for controlling pulsating backgrounds
			var currentFrame = 0;
			setInterval(function() {
				currentFrame = (currentFrame + 1) % 50;
				var opacity = -Math.abs(currentFrame - 25) + 25, bgcolor = 'rgb(' + opacity * 2 + ',' + Math.round(opacity * 2 + 172) + ',' + Math.round(opacity * 2 + 193) +')', tcolor = 'rgb(' + Math.round((-opacity + 25) * 2.55 + 191) + ',' + Math.round((-opacity + 25) * 2.55 + 191) + ',' + Math.round((-opacity + 25) * 2.55 + 191) +')';
				Array.prototype.forEach.call(document.querySelectorAll('[data-selected-element=selected]'), function(element) {
					element.style.backgroundColor = 'rgba(0,172,193,'+(.006*opacity+.15)+')';
				});
				Array.prototype.forEach.call(document.getElementsByClassName('html-escape-sequence-replacer'), function(element) {
					//element.style.backgroundColor = bgcolor;
					element.style.color = tcolor;
				})
			}, 20);
			overlayUpdate();
			history.update();
		}();
	</script>
</body>
</html>
